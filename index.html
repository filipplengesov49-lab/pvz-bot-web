<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ì—Ä–∞—Ñ–∏–∫ –ü–í–ó</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }
    
    .container {
      max-width: 500px;
      margin: 0 auto;
    }
    
    .header {
      background: white;
      border-radius: 16px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.15);
      text-align: center;
    }
    
    .header h1 {
      color: #333;
      margin-bottom: 15px;
      font-size: 24px;
    }
    
    .current-point-info {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      padding: 15px;
      border-radius: 12px;
      margin-bottom: 20px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.15);
      display: none;
    }
    
    .current-point-info.active {
      display: block;
    }
    
    .current-point-info h2 {
      margin: 0 0 8px 0;
      font-size: 18px;
    }
    
    .current-point-info p {
      margin: 0;
      font-size: 14px;
      opacity: 0.9;
    }
    
    .stats {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      margin-top: 10px;
    }
    
    .stat-item {
      background: #f8f9fa;
      padding: 10px;
      border-radius: 8px;
      text-align: center;
    }
    
    .stat-number {
      font-size: 24px;
      font-weight: bold;
      color: #667eea;
    }
    
    .stat-label {
      font-size: 12px;
      color: #666;
      margin-top: 2px;
    }
    
    .action-buttons {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      margin-bottom: 20px;
    }
    
    .btn {
      padding: 15px;
      border: none;
      border-radius: 12px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      transition: transform 0.1s, box-shadow 0.2s;
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    
    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 15px rgba(0,0,0,0.2);
    }
    
    .btn-primary {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    }
    
    .btn-secondary {
      background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
    }
    
    .btn-success {
      background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
    }
    
    .btn-warning {
      background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
    }
    
    .btn-danger {
      background: linear-gradient(135deg, #ff416c, #ff4b2b);
    }
    
    .btn-back {
      background: linear-gradient(135deg, #a8edea, #fed6e3);
      color: #333;
    }
    
    .calendar {
      background: white;
      border-radius: 16px;
      padding: 20px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.15);
    }
    
    .month-header {
      text-align: center;
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 15px;
      color: #333;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    
    .month-nav {
      background: none;
      border: none;
      font-size: 20px;
      cursor: pointer;
      color: #667eea;
      padding: 5px 10px;
    }
    
    .weekdays {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      text-align: center;
      font-weight: bold;
      color: #888;
      margin-bottom: 10px;
      font-size: 14px;
    }
    
    .days {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 5px;
    }
    
    .day {
      aspect-ratio: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 10px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.2s;
      font-size: 14px;
      position: relative;
      overflow: hidden;
    }
    
    .day:hover {
      transform: scale(1.1);
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }
    
    .day.empty {
      background: transparent;
      cursor: default;
    }
    
    .day.free {
      background: linear-gradient(135deg, #ff6b6b, #ee5a6f);
      color: white;
    }
    
    .day.free::after {
      content: '';
      position: absolute;
      bottom: 4px;
      right: 4px;
      width: 6px;
      height: 6px;
      background: rgba(255,255,255,0.5);
      border-radius: 50%;
    }
    
    .day.busy {
      background: linear-gradient(135deg, #4caf50, #43a047);
      color: white;
    }
    
    .day.busy::after {
      content: '';
      position: absolute;
      bottom: 4px;
      right: 4px;
      width: 6px;
      height: 6px;
      background: rgba(255,255,255,0.8);
      border-radius: 50%;
    }
    
    .day.today {
      border: 3px solid #667eea;
      background: linear-gradient(135deg, #667eea, #764ba2) !important;
    }
    
    .day.today::after {
      display: none;
    }
    
    .day-number {
      position: relative;
      z-index: 1;
    }
    
    /* –ü–æ–ø-–∞–ø –æ–∫–Ω–∞ */
    .popup {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.7);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s;
    }
    
    .popup.active {
      opacity: 1;
      pointer-events: all;
    }
    
    .popup-content {
      background: white;
      border-radius: 20px;
      padding: 25px;
      width: 90%;
      max-width: 450px;
      max-height: 80vh;
      overflow-y: auto;
      box-shadow: 0 10px 40px rgba(0,0,0,0.3);
      transform: translateY(20px);
      transition: transform 0.3s;
    }
    
    .popup.active .popup-content {
      transform: translateY(0);
    }
    
    .popup-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 2px solid #f0f0f0;
    }
    
    .popup h3 {
      margin: 0;
      color: #333;
      font-size: 20px;
    }
    
    .popup-close {
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: #999;
      padding: 5px;
    }
    
    .popup-close:hover {
      color: #333;
    }
    
    .form-group {
      margin-bottom: 15px;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 8px;
      color: #555;
      font-weight: 500;
    }
    
    .form-group input {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid #e0e0e0;
      border-radius: 10px;
      font-size: 16px;
      transition: border-color 0.2s;
    }
    
    .form-group input:focus {
      outline: none;
      border-color: #667eea;
    }
    
    .form-actions {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-top: 20px;
    }
    
    .points-list, .employees-list {
      display: flex;
      flex-direction: column;
      gap: 10px;
      max-height: 400px;
      overflow-y: auto;
    }
    
    .point-item, .employee-item {
      background: #f8f9fa;
      padding: 12px 15px;
      border-radius: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: pointer;
      transition: background 0.2s;
    }
    
    .point-item:hover, .employee-item:hover {
      background: #e9ecef;
    }
    
    .point-info, .employee-info {
      flex: 1;
    }
    
    .point-name, .employee-name {
      font-weight: bold;
      color: #333;
      margin-bottom: 4px;
    }
    
    .point-address, .employee-details {
      color: #666;
      font-size: 14px;
    }
    
    .point-actions, .employee-actions {
      display: flex;
      gap: 8px;
    }
    
    .action-btn {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      transition: transform 0.1s;
    }
    
    .action-btn:hover {
      transform: scale(1.1);
    }
    
    .action-btn.delete {
      background: #ff6b6b;
      color: white;
    }
    
    .action-btn.calendar {
      background: #43e97b;
      color: white;
    }
    
    .toast {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%) translateY(100px);
      background: white;
      padding: 15px 25px;
      border-radius: 10px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.2);
      z-index: 2000;
      transition: transform 0.3s;
      font-weight: bold;
      color: #333;
    }
    
    .toast.show {
      transform: translateX(-50%) translateY(0);
    }
    
    .toast.success {
      background: linear-gradient(135deg, #43e97b, #38f9d7);
      color: white;
    }
    
    .toast.error {
      background: linear-gradient(135deg, #ff6b6b, #ee5a6f);
      color: white;
    }
    
    .toast.warning {
      background: linear-gradient(135deg, #ffa726, #ff9800);
      color: white;
    }
    
    .confirm-popup {
      text-align: center;
      padding: 20px 0;
    }
    
    .confirm-popup p {
      margin-bottom: 20px;
      color: #555;
      font-size: 16px;
    }
    
    .confirm-actions {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    
    .empty-state {
      text-align: center;
      color: #999;
      padding: 40px 20px;
    }
    
    .empty-state h4 {
      margin-bottom: 10px;
      color: #666;
    }
    
    .empty-state p {
      margin-bottom: 20px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üè¢ –ì—Ä–∞—Ñ–∏–∫ –ü–í–ó</h1>
      <div class="stats">
        <div class="stat-item">
          <div class="stat-number" id="points-count">0</div>
          <div class="stat-label">–ü—É–Ω–∫—Ç–æ–≤</div>
        </div>
        <div class="stat-item">
          <div class="stat-number" id="employees-count">0</div>
          <div class="stat-label">–°–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</div>
        </div>
      </div>
    </div>
    
    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º –ø—É–Ω–∫—Ç–µ -->
    <div class="current-point-info" id="current-point-info">
      <h2 id="current-point-name">–ü–í–ó –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π</h2>
      <p id="current-point-address">—É–ª. –õ–µ–Ω–∏–Ω–∞, 10</p>
    </div>
    
    <div class="action-buttons">
      <button class="btn btn-primary" onclick="showAddPointPopup()">
        <span>‚ûï</span> –ü–í–ó
      </button>
      <button class="btn btn-secondary" onclick="showAddEmployeePopup()">
        <span>üë§</span> –°–æ—Ç—Ä—É–¥–Ω–∏–∫
      </button>
      <button class="btn btn-success" onclick="showPointsList()">
        <span>üìç</span> –ú–æ–∏ –ü–í–ó
      </button>
      <button class="btn btn-warning" onclick="showEmployeesList()">
        <span>üë•</span> –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏
      </button>
    </div>
    
    <div class="calendar">
      <div class="month-header">
        <button class="month-nav" onclick="changeMonth(-1)">‚ùÆ</button>
        <div id="month-name">–Ø–Ω–≤–∞—Ä—å 2026</div>
        <button class="month-nav" onclick="changeMonth(1)">‚ùØ</button>
      </div>
      <div class="weekdays">
        <div>–ü–Ω</div>
        <div>–í—Ç</div>
        <div>–°—Ä</div>
        <div>–ß—Ç</div>
        <div>–ü—Ç</div>
        <div>–°–±</div>
        <div>–í—Å</div>
      </div>
      <div class="days" id="days-container">
        <!-- –î–Ω–∏ –±—É–¥—É—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è —Å–∫—Ä–∏–ø—Ç–æ–º -->
      </div>
    </div>
  </div>
  
  <!-- –ü–æ–ø-–∞–ø –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ü–í–ó -->
  <div class="popup" id="add-point-popup">
    <div class="popup-content">
      <div class="popup-header">
        <h3>‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø—É–Ω–∫—Ç –≤—ã–¥–∞—á–∏</h3>
        <button class="popup-close" onclick="closePopup('add-point-popup')">√ó</button>
      </div>
      <div class="form-group">
        <label for="point-name">–ù–∞–∑–≤–∞–Ω–∏–µ –ü–í–ó *</label>
        <input type="text" id="point-name" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ü–í–ó –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π" maxlength="100">
      </div>
      <div class="form-group">
        <label for="point-address">–ê–¥—Ä–µ—Å *</label>
        <input type="text" id="point-address" placeholder="—É–ª. –õ–µ–Ω–∏–Ω–∞, 10">
      </div>
      <div class="form-actions">
        <button class="btn btn-secondary" onclick="closePopup('add-point-popup')">–û—Ç–º–µ–Ω–∞</button>
        <button class="btn btn-primary" onclick="addPoint()">–î–æ–±–∞–≤–∏—Ç—å</button>
      </div>
    </div>
  </div>
  
  <!-- –ü–æ–ø-–∞–ø –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ -->
  <div class="popup" id="add-employee-popup">
    <div class="popup-content">
      <div class="popup-header">
        <h3>üë§ –î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</h3>
        <button class="popup-close" onclick="closePopup('add-employee-popup')">√ó</button>
      </div>
      <div class="form-group">
        <label for="employee-name">–§–ò–û —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ *</label>
        <input type="text" id="employee-name" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤" maxlength="100">
      </div>
      <div class="form-group">
        <label for="employee-phone">–¢–µ–ª–µ—Ñ–æ–Ω (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
        <input type="tel" id="employee-phone" placeholder="+7 (999) 123-45-67">
      </div>
      <div class="form-group">
        <label for="employee-rate">–°—Ç–∞–≤–∫–∞ –∑–∞ –¥–µ–Ω—å (‚ÇΩ)</label>
        <input type="number" id="employee-rate" placeholder="1000" value="1000" min="0">
      </div>
      <div class="form-actions">
        <button class="btn btn-secondary" onclick="closePopup('add-employee-popup')">–û—Ç–º–µ–Ω–∞</button>
        <button class="btn btn-primary" onclick="addEmployee()">–î–æ–±–∞–≤–∏—Ç—å</button>
      </div>
    </div>
  </div>
  
  <!-- –ü–æ–ø-–∞–ø —Å–ø–∏—Å–∫–∞ –ü–í–ó -->
  <div class="popup" id="points-list-popup">
    <div class="popup-content">
      <div class="popup-header">
        <h3>üìç –ú–æ–∏ –ø—É–Ω–∫—Ç—ã –≤—ã–¥–∞—á–∏</h3>
        <button class="popup-close" onclick="closePopup('points-list-popup')">√ó</button>
      </div>
      <div class="points-list" id="points-list">
        <!-- –°–ø–∏—Å–æ–∫ –ü–í–ó –±—É–¥–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è -->
      </div>
    </div>
  </div>
  
  <!-- –ü–æ–ø-–∞–ø —Å–ø–∏—Å–∫–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ -->
  <div class="popup" id="employees-list-popup">
    <div class="popup-content">
      <div class="popup-header">
        <h3>üë• –ú–æ–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏</h3>
        <button class="popup-close" onclick="closePopup('employees-list-popup')">√ó</button>
      </div>
      <div class="employees-list" id="employees-list">
        <!-- –°–ø–∏—Å–æ–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –±—É–¥–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è -->
      </div>
    </div>
  </div>
  
  <!-- –ü–æ–ø-–∞–ø –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —É–¥–∞–ª–µ–Ω–∏—è -->
  <div class="popup" id="confirm-delete-popup">
    <div class="popup-content">
      <div class="popup-header">
        <h3>‚ö†Ô∏è –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ</h3>
        <button class="popup-close" onclick="closePopup('confirm-delete-popup')">√ó</button>
      </div>
      <div class="confirm-popup">
        <p id="confirm-delete-message">–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –ø—É–Ω–∫—Ç?</p>
        <div class="confirm-actions">
          <button class="btn btn-secondary" onclick="closePopup('confirm-delete-popup')">–û—Ç–º–µ–Ω–∞</button>
          <button class="btn btn-danger" id="confirm-delete-btn">–£–¥–∞–ª–∏—Ç—å</button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- –ü–æ–ø-–∞–ø –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –¥—É–±–ª–∏–∫–∞—Ç–∞ -->
  <div class="popup" id="confirm-duplicate-popup">
    <div class="popup-content">
      <div class="popup-header">
        <h3>‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ</h3>
        <button class="popup-close" onclick="closePopup('confirm-duplicate-popup')">√ó</button>
      </div>
      <div class="confirm-popup">
        <p id="confirm-duplicate-message">–¢–∞–∫–æ–π –ø—É–Ω–∫—Ç —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –î–æ–±–∞–≤–∏—Ç—å –µ—â—ë —Ä–∞–∑?</p>
        <div class="confirm-actions">
          <button class="btn btn-secondary" onclick="closePopup('confirm-duplicate-popup')">–û—Ç–º–µ–Ω–∞</button>
          <button class="btn btn-primary" id="confirm-add-btn">–î–æ–±–∞–≤–∏—Ç—å</button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- –ü–æ–ø-–∞–ø –¥–Ω—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è -->
  <div class="popup" id="day-popup">
    <div class="popup-content">
      <div class="popup-header">
        <h3 id="popup-date">27 —è–Ω–≤–∞—Ä—è</h3>
        <button class="popup-close" onclick="closePopup('day-popup')">√ó</button>
      </div>
      <div style="text-align: center; padding: 20px;">
        <div style="font-size: 48px; margin-bottom: 10px;">üìÖ</div>
        <p style="color: #666; margin-bottom: 20px;">
          –í—ã–±–µ—Ä–∏—Ç–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã –≤ —ç—Ç–æ—Ç –¥–µ–Ω—å
        </p>
        <div id="day-employees-list">
          <!-- –°–ø–∏—Å–æ–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –¥–ª—è –≤—ã–±–æ—Ä–∞ -->
        </div>
        <div id="day-assigned-employee" style="display: none; margin-top: 20px;">
          <p style="color: #4caf50; font-weight: bold; margin-bottom: 10px;">‚úÖ –ù–∞–∑–Ω–∞—á–µ–Ω:</p>
          <div id="assigned-employee-name" style="font-size: 18px; margin-bottom: 15px;"></div>
          <button class="btn btn-danger" onclick="clearDayAssignment()">–û—á–∏—Å—Ç–∏—Ç—å –¥–µ–Ω—å</button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
  <div class="toast" id="toast"></div>
  
  <script>
    // ===== –•–†–ê–ù–ò–õ–ò–©–ï –î–ê–ù–ù–´–• (localStorage) =====
    let currentYear = new Date().getFullYear();
    let currentMonth = new Date().getMonth();
    let currentPointId = null; // ID –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –ø—É–Ω–∫—Ç–∞
    let points = JSON.parse(localStorage.getItem('pvz_points')) || [];
    let employees = JSON.parse(localStorage.getItem('pvz_employees')) || [];
    let schedule = JSON.parse(localStorage.getItem('pvz_schedule')) || []; // { pointId, employeeId, date }
    
    // ===== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø =====
    document.addEventListener('DOMContentLoaded', () => {
      updateStats();
      generateCalendar(currentYear, currentMonth);
    });
    
    // ===== –ö–ê–õ–ï–ù–î–ê–†–¨ =====
    const monthNames = ["–Ø–Ω–≤–∞—Ä—å", "–§–µ–≤—Ä–∞–ª—å", "–ú–∞—Ä—Ç", "–ê–ø—Ä–µ–ª—å", "–ú–∞–π", "–ò—é–Ω—å",
      "–ò—é–ª—å", "–ê–≤–≥—É—Å—Ç", "–°–µ–Ω—Ç—è–±—Ä—å", "–û–∫—Ç—è–±—Ä—å", "–ù–æ—è–±—Ä—å", "–î–µ–∫–∞–±—Ä—å"];
    
    function generateCalendar(year, month) {
      currentYear = year;
      currentMonth = month;
      
      document.getElementById('month-name').textContent = `${monthNames[month]} ${year}`;
      
      const daysContainer = document.getElementById('days-container');
      daysContainer.innerHTML = '';
      
      const firstDay = new Date(year, month, 1).getDay() || 7; // –ü–Ω = 1, –í—Å = 7
      const daysInMonth = new Date(year, month + 1, 0).getDate();
      const today = new Date();
      const isCurrentMonth = year === today.getFullYear() && month === today.getMonth();
      
      // –ü—É—Å—Ç—ã–µ –¥–Ω–∏ –¥–æ –Ω–∞—á–∞–ª–∞ –º–µ—Å—è—Ü–∞
      for (let i = 1; i < firstDay; i++) {
        const empty = document.createElement('div');
        empty.className = 'day empty';
        daysContainer.appendChild(empty);
      }
      
      // –î–Ω–∏ –º–µ—Å—è—Ü–∞
      for (let day = 1; day <= daysInMonth; day++) {
        const dayEl = document.createElement('div');
        dayEl.className = 'day';
        
        const dayNumber = document.createElement('div');
        dayNumber.className = 'day-number';
        dayNumber.textContent = day;
        dayEl.appendChild(dayNumber);
        
        const dateStr = formatDate(year, month, day);
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –∑–∞–ø–∏—Å—å –≤ –≥—Ä–∞—Ñ–∏–∫–µ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ü–í–ó
        const isScheduled = currentPointId && schedule.some(s => 
          s.pointId === currentPointId && s.date === dateStr
        );
        
        dayEl.classList.add(isScheduled ? 'busy' : 'free');
        
        // –°–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –¥–µ–Ω—å
        if (isCurrentMonth && day === today.getDate()) {
          dayEl.classList.add('today');
        }
        
        // –ö–ª–∏–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω –ü–í–ó
        if (currentPointId) {
          dayEl.onclick = () => showDayPopup(day, month, year);
        } else {
          dayEl.style.cursor = 'not-allowed';
          dayEl.title = '–í—ã–±–µ—Ä–∏—Ç–µ –ø—É–Ω–∫—Ç –≤—ã–¥–∞—á–∏ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è';
        }
        
        daysContainer.appendChild(dayEl);
      }
    }
    
    function changeMonth(delta) {
      currentMonth += delta;
      if (currentMonth < 0) {
        currentMonth = 11;
        currentYear--;
      } else if (currentMonth > 11) {
        currentMonth = 0;
        currentYear++;
      }
      generateCalendar(currentYear, currentMonth);
    }
    
    function formatDate(year, month, day) {
      return `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
    }
    
    // ===== –ü–û–ü-–ê–ü –û–ö–ù–ê =====
    function showPopup(id) {
      document.getElementById(id).classList.add('active');
    }
    
    function closePopup(id) {
      document.getElementById(id).classList.remove('active');
    }
    
    function showAddPointPopup() {
      document.getElementById('point-name').value = '';
      document.getElementById('point-address').value = '';
      showPopup('add-point-popup');
    }
    
    function showAddEmployeePopup() {
      document.getElementById('employee-name').value = '';
      document.getElementById('employee-phone').value = '';
      document.getElementById('employee-rate').value = '1000';
      showPopup('add-employee-popup');
    }
    
    function showPointsList() {
      renderPointsList();
      showPopup('points-list-popup');
    }
    
    function showEmployeesList() {
      renderEmployeesList();
      showPopup('employees-list-popup');
    }
    
    function showDayPopup(day, month, year) {
      const dateStr = formatDate(year, month, day);
      document.getElementById('popup-date').textContent = `${day} ${monthNames[month].toLowerCase()} ${year}`;
      
      // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ø–∏—Å–æ–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –¥–ª—è –≤—ã–±–æ—Ä–∞
      const listEl = document.getElementById('day-employees-list');
      const assignedEl = document.getElementById('day-assigned-employee');
      const assignedNameEl = document.getElementById('assigned-employee-name');
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–∞–∑–Ω–∞—á–µ–Ω –ª–∏ —É–∂–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫
      const existing = schedule.find(s => s.pointId === currentPointId && s.date === dateStr);
      
      if (existing) {
        const employee = employees.find(e => e.id === existing.employeeId);
        assignedNameEl.textContent = employee ? employee.name : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π';
        assignedEl.style.display = 'block';
        listEl.style.display = 'none';
      } else {
        assignedEl.style.display = 'none';
        listEl.style.display = 'block';
        
        if (employees.length === 0) {
          listEl.innerHTML = '<p style="color: #999;">–°–Ω–∞—á–∞–ª–∞ –¥–æ–±–∞–≤—å—Ç–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</p>';
        } else {
          let html = '';
          employees.forEach(emp => {
            html += `
              <div class="employee-item" onclick="assignEmployeeToDay(${emp.id}, '${dateStr}')">
                <div class="employee-info">
                  <div class="employee-name">${emp.name}</div>
                  <div class="employee-details">${emp.phone || ''}</div>
                </div>
                <div style="font-size: 24px;">‚û°Ô∏è</div>
              </div>
            `;
          });
          listEl.innerHTML = html;
        }
      }
      
      showPopup('day-popup');
    }
    
    // ===== –î–û–ë–ê–í–õ–ï–ù–ò–ï –ü–í–ó =====
    function addPoint() {
      const name = document.getElementById('point-name').value.trim();
      const address = document.getElementById('point-address').value.trim();
      
      if (!name || name.length < 2) {
        showToast('–ù–∞–∑–≤–∞–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ 2 —Å–∏–º–≤–æ–ª–æ–≤', 'error');
        return;
      }
      
      if (!address || address.length < 5) {
        showToast('–ê–¥—Ä–µ—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ 5 —Å–∏–º–≤–æ–ª–æ–≤', 'error');
        return;
      }
      
      // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç
      const existingPoint = points.find(p => 
        p.name.toLowerCase() === name.toLowerCase() || 
        p.address.toLowerCase() === address.toLowerCase()
      );
      
      if (existingPoint) {
        document.getElementById('confirm-duplicate-message').textContent = 
          `–ü—É–Ω–∫—Ç —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º "${name}" –∏–ª–∏ –∞–¥—Ä–µ—Å–æ–º "${address}" —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –î–æ–±–∞–≤–∏—Ç—å –µ—â—ë —Ä–∞–∑?`;
        
        document.getElementById('confirm-add-btn').onclick = () => {
          doAddPoint(name, address);
          closePopup('confirm-duplicate-popup');
        };
        
        showPopup('confirm-duplicate-popup');
        return;
      }
      
      doAddPoint(name, address);
    }
    
    function doAddPoint(name, address) {
      const newPoint = {
        id: points.length > 0 ? Math.max(...points.map(p => p.id)) + 1 : 1,
        name: name,
        address: address
      };
      
      points.push(newPoint);
      localStorage.setItem('pvz_points', JSON.stringify(points));
      
      closePopup('add-point-popup');
      showToast('‚úÖ –ü–í–ó –¥–æ–±–∞–≤–ª–µ–Ω!', 'success');
      updateStats();
      renderPointsList();
    }
    
    // ===== –î–û–ë–ê–í–õ–ï–ù–ò–ï –°–û–¢–†–£–î–ù–ò–ö–ê =====
    function addEmployee() {
      const name = document.getElementById('employee-name').value.trim();
      const phone = document.getElementById('employee-phone').value.trim();
      const rate = parseFloat(document.getElementById('employee-rate').value) || 1000;
      
      if (!name || name.length < 2) {
        showToast('–§–ò–û –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ 2 —Å–∏–º–≤–æ–ª–æ–≤', 'error');
        return;
      }
      
      // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç –ø–æ –∏–º–µ–Ω–∏
      const existingEmployee = employees.find(e => e.name.toLowerCase() === name.toLowerCase());
      
      if (existingEmployee) {
        document.getElementById('confirm-duplicate-message').textContent = 
          `–°–æ—Ç—Ä—É–¥–Ω–∏–∫ "${name}" —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –î–æ–±–∞–≤–∏—Ç—å –µ—â—ë —Ä–∞–∑?`;
        
        document.getElementById('confirm-add-btn').onclick = () => {
          doAddEmployee(name, phone, rate);
          closePopup('confirm-duplicate-popup');
        };
        
        showPopup('confirm-duplicate-popup');
        return;
      }
      
      doAddEmployee(name, phone, rate);
    }
    
    function doAddEmployee(name, phone, rate) {
      const newEmployee = {
        id: employees.length > 0 ? Math.max(...employees.map(e => e.id)) + 1 : 1,
        name: name,
        phone: phone,
        rate: rate
      };
      
      employees.push(newEmployee);
      localStorage.setItem('pvz_employees', JSON.stringify(employees));
      
      closePopup('add-employee-popup');
      showToast('‚úÖ –°–æ—Ç—Ä—É–¥–Ω–∏–∫ –¥–æ–±–∞–≤–ª–µ–Ω!', 'success');
      updateStats();
      renderEmployeesList();
    }
    
    // ===== –£–î–ê–õ–ï–ù–ò–ï –ü–í–ó =====
    function confirmDeletePoint(pointId) {
      const point = points.find(p => p.id === pointId);
      document.getElementById('confirm-delete-message').textContent = 
        `–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å "${point.name}"? –í—Å–µ –¥–∞–Ω–Ω—ã–µ –æ –≥—Ä–∞—Ñ–∏–∫–µ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã.`;
      
      document.getElementById('confirm-delete-btn').onclick = () => {
        deletePoint(pointId);
        closePopup('confirm-delete-popup');
      };
      
      showPopup('confirm-delete-popup');
    }
    
    function deletePoint(pointId) {
      // –£–¥–∞–ª—è–µ–º —Å–∞–º –ü–í–ó
      points = points.filter(p => p.id !== pointId);
      
      // –£–¥–∞–ª—è–µ–º –≤—Å–µ –∑–∞–ø–∏—Å–∏ –∏–∑ –≥—Ä–∞—Ñ–∏–∫–∞ –¥–ª—è —ç—Ç–æ–≥–æ –ü–í–ó
      schedule = schedule.filter(s => s.pointId !== pointId);
      
      localStorage.setItem('pvz_points', JSON.stringify(points));
      localStorage.setItem('pvz_schedule', JSON.stringify(schedule));
      
      // –ï—Å–ª–∏ —É–¥–∞–ª—è–µ–º —Ç–µ–∫—É—â–∏–π –ü–í–ó, —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—ã–±–æ—Ä
      if (currentPointId === pointId) {
        currentPointId = null;
        document.getElementById('current-point-info').classList.remove('active');
        generateCalendar(currentYear, currentMonth);
      }
      
      showToast('‚úÖ –ü–í–ó —É–¥–∞–ª—ë–Ω!', 'success');
      updateStats();
      renderPointsList();
    }
    
    // ===== –£–î–ê–õ–ï–ù–ò–ï –°–û–¢–†–£–î–ù–ò–ö–ê =====
    function confirmDeleteEmployee(employeeId) {
      const employee = employees.find(e => e.id === employeeId);
      document.getElementById('confirm-delete-message').textContent = 
        `–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å "${employee.name}"? –í—Å–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –≤ –≥—Ä–∞—Ñ–∏–∫–µ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã.`;
      
      document.getElementById('confirm-delete-btn').onclick = () => {
        deleteEmployee(employeeId);
        closePopup('confirm-delete-popup');
      };
      
      showPopup('confirm-delete-popup');
    }
    
    function deleteEmployee(employeeId) {
      // –£–¥–∞–ª—è–µ–º —Å–∞–º–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
      employees = employees.filter(e => e.id !== employeeId);
      
      // –£–¥–∞–ª—è–µ–º –≤—Å–µ –∑–∞–ø–∏—Å–∏ –∏–∑ –≥—Ä–∞—Ñ–∏–∫–∞ –¥–ª—è —ç—Ç–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
      schedule = schedule.filter(s => s.employeeId !== employeeId);
      
      localStorage.setItem('pvz_employees', JSON.stringify(employees));
      localStorage.setItem('pvz_schedule', JSON.stringify(schedule));
      
      showToast('‚úÖ –°–æ—Ç—Ä—É–¥–Ω–∏–∫ —É–¥–∞–ª—ë–Ω!', 'success');
      updateStats();
      renderEmployeesList();
    }
    
    // ===== –ù–ê–ó–ù–ê–ß–ï–ù–ò–ï –°–û–¢–†–£–î–ù–ò–ö–ê –ù–ê –î–ï–ù–¨ =====
    function assignEmployeeToDay(employeeId, dateStr) {
      if (!currentPointId) {
        showToast('‚ùå –°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –ø—É–Ω–∫—Ç –≤—ã–¥–∞—á–∏', 'error');
        return;
      }
      
      // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—É—é –∑–∞–ø–∏—Å—å –¥–ª—è —ç—Ç–æ–≥–æ –¥–Ω—è (–µ—Å–ª–∏ –µ—Å—Ç—å)
      schedule = schedule.filter(s => !(s.pointId === currentPointId && s.date === dateStr));
      
      // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—É—é
      schedule.push({
        pointId: currentPointId,
        employeeId: employeeId,
        date: dateStr
      });
      
      localStorage.setItem('pvz_schedule', JSON.stringify(schedule));
      
      const employee = employees.find(e => e.id === employeeId);
      showToast(`üìÖ ${employee.name} –Ω–∞–∑–Ω–∞—á–µ–Ω –Ω–∞ ${dateStr}`, 'success');
      closePopup('day-popup');
      generateCalendar(currentYear, currentMonth);
    }
    
    // ===== –û–ß–ò–°–¢–ö–ê –î–ù–Ø =====
    function clearDayAssignment() {
      const dateStr = document.getElementById('popup-date').textContent;
      // –ò–∑–≤–ª–µ–∫–∞–µ–º –¥–∞—Ç—É –∏–∑ —Ñ–æ—Ä–º–∞—Ç–∞ "27 —è–Ω–≤–∞—Ä—è 2026"
      const [day, monthName, year] = dateStr.split(' ');
      const monthIndex = monthNames.findIndex(m => m.toLowerCase() === monthName);
      const fullDate = formatDate(parseInt(year), monthIndex, parseInt(day));
      
      schedule = schedule.filter(s => !(s.pointId === currentPointId && s.date === fullDate));
      localStorage.setItem('pvz_schedule', JSON.stringify(schedule));
      
      showToast('‚úÖ –î–µ–Ω—å –æ—á–∏—â–µ–Ω', 'success');
      closePopup('day-popup');
      generateCalendar(currentYear, currentMonth);
    }
    
    // ===== –í–´–ë–û–† –ü–í–ó –î–õ–Ø –†–ï–î–ê–ö–¢–ò–†–û–í–ê–ù–ò–Ø =====
    function selectPointForEditing(pointId) {
      const point = points.find(p => p.id === pointId);
      currentPointId = pointId;
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º –ü–í–ó
      document.getElementById('current-point-name').textContent = point.name;
      document.getElementById('current-point-address').textContent = point.address;
      document.getElementById('current-point-info').classList.add('active');
      
      closePopup('points-list-popup');
      showToast(`‚úÖ –í—ã–±—Ä–∞–Ω: ${point.name}`, 'success');
      generateCalendar(currentYear, currentMonth);
    }
    
    // ===== –û–¢–û–ë–†–ê–ñ–ï–ù–ò–ï –°–ü–ò–°–ö–û–í =====
    function renderPointsList() {
      const listEl = document.getElementById('points-list');
      
      if (points.length === 0) {
        listEl.innerHTML = `
          <div class="empty-state">
            <h4>üì≠ –ü—É—Å—Ç–æ</h4>
            <p>–ü–æ–∫–∞ –Ω–µ—Ç –ø—É–Ω–∫—Ç–æ–≤ –≤—ã–¥–∞—á–∏</p>
            <button class="btn btn-primary" onclick="showAddPointPopup()">‚ûï –î–æ–±–∞–≤–∏—Ç—å –ü–í–ó</button>
          </div>
        `;
        return;
      }
      
      let html = '';
      points.forEach(point => {
        html += `
          <div class="point-item">
            <div class="point-info" onclick="selectPointForEditing(${point.id})">
              <div class="point-name">${point.name}</div>
              <div class="point-address">${point.address}</div>
            </div>
            <div class="point-actions">
              <button class="action-btn calendar" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å" onclick="selectPointForEditing(${point.id})">üìÖ</button>
              <button class="action-btn delete" title="–£–¥–∞–ª–∏—Ç—å" onclick="confirmDeletePoint(${point.id})">üóëÔ∏è</button>
            </div>
          </div>
        `;
      });
      
      listEl.innerHTML = html;
    }
    
    function renderEmployeesList() {
      const listEl = document.getElementById('employees-list');
      
      if (employees.length === 0) {
        listEl.innerHTML = `
          <div class="empty-state">
            <h4>üì≠ –ü—É—Å—Ç–æ</h4>
            <p>–ü–æ–∫–∞ –Ω–µ—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</p>
            <button class="btn btn-secondary" onclick="showAddEmployeePopup()">üë§ –î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</button>
          </div>
        `;
        return;
      }
      
      let html = '';
      employees.forEach(emp => {
        html += `
          <div class="employee-item">
            <div class="employee-info">
              <div class="employee-name">${emp.name}</div>
              <div class="employee-details">${emp.phone || ''} ‚Ä¢ ${emp.rate}‚ÇΩ/–¥–µ–Ω—å</div>
            </div>
            <div class="employee-actions">
              <button class="action-btn delete" title="–£–¥–∞–ª–∏—Ç—å" onclick="confirmDeleteEmployee(${emp.id})">üóëÔ∏è</button>
            </div>
          </div>
        `;
      });
      
      listEl.innerHTML = html;
    }
    
    // ===== –°–¢–ê–¢–ò–°–¢–ò–ö–ê =====
    function updateStats() {
      document.getElementById('points-count').textContent = points.length;
      document.getElementById('employees-count').textContent = employees.length;
    }
    
    // ===== –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø =====
    function showToast(message, type = 'success') {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.className = `toast ${type} show`;
      
      setTimeout(() => {
        toast.classList.remove('show');
      }, 3000);
    }
  </script>
</body>
</html>
